(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-12217ac6"],{"0fea":function(t,n,e){"use strict";e.d(n,"e",function(){return o}),e.d(n,"g",function(){return i}),e.d(n,"c",function(){return u}),e.d(n,"a",function(){return c}),e.d(n,"d",function(){return d}),e.d(n,"b",function(){return l}),e.d(n,"f",function(){return s});var r=e("365c"),a=e("b775");function o(t){return Object(a["b"])({url:r["a"].user,method:"get",params:t})}function i(t,n){return Object(a["b"])({url:r["a"].user+"".concat(t,"/"),method:"put",data:n})}function u(t){return Object(a["b"])({url:r["a"].user,method:"post",data:t})}function c(t,n){return Object(a["b"])({url:r["a"].user+"".concat(t,"/")+"admin_change_password/",method:"post",data:n})}function d(t){return Object(a["b"])({url:r["a"].role,method:"get",params:t})}function l(t){return Object(a["b"])({url:r["a"].role,method:"post",data:t})}function s(t,n){return Object(a["b"])({url:r["a"].role+"".concat(t,"/"),method:"put",data:n})}},2014:function(t,n,e){"use strict";e.r(n);var r=function(){var t=this,n=t.$createElement,e=t._self._c||n;return e("detail",{attrs:{"is-edit":!0},on:{title:t.onTitle}})},a=[],o=e("c817"),i={name:"EditCoupon",components:{Detail:o["a"]},data:function(){return{description:"编辑优惠券"}},methods:{onTitle:function(){this.$parent.getPageMeta()}}},u=i,c=e("2877"),d=Object(c["a"])(u,r,a,!1,null,null,null);n["default"]=d.exports},c817:function(t,n,e){"use strict";var r=function(){var t=this,n=t.$createElement,e=t._self._c||n;return e("a-card",{attrs:{loading:t.loading}},[e("a-form",{attrs:{form:t.form}},[e("a-form-item",{attrs:{label:"CouponID"}},[e("a-input",{attrs:{disabled:""},model:{value:t.form.couponID,callback:function(n){t.$set(t.form,"couponID",n)},expression:"form.couponID"}})],1),e("a-form-item",{attrs:{label:"Product"}},[e("a-select",{attrs:{showSearch:!0,showArrow:!1,value:t.product_id,filterOption:!1,notFoundContent:t.loadingProduct?void 0:null},on:{search:t.handleProductSearch,change:t.handleProductChange}},[t.loadingProduct?e("a-spin",{attrs:{slot:"notFoundContent",size:"small"},slot:"notFoundContent"}):t._e(),t._l(t.productOption,function(n){return e("a-select-option",{key:n.id,attrs:{value:n.id}},[t._v(t._s(n.title))])})],2)],1),e("a-form-item",{attrs:{label:"variant","validate-status":null==t.help.variant_id||""===t.help.variant_id?null:"error",help:t.help.variant_id}},[e("a-select",{attrs:{value:t.form.variant_id,allowClear:"",notFoundContent:null},on:{change:t.handleVariantChange}},t._l(t.variantOption,function(n){return e("a-select-option",{key:n.id,attrs:{value:n.id}},[t._v(t._s(n.name))])}),1)],1),e("a-form-item",{attrs:{label:"Customer","validate-status":null==t.help.customer_id||""===t.help.customer_id?null:"error",help:t.help.customer_id}},[e("a-select",{attrs:{mode:"multiple",showSearch:!0,showArrow:!1,value:t.form.customer_id,filterOption:!1,notFoundContent:t.loadingCustomer?void 0:null},on:{search:t.handleCustomerSearch,change:t.handleCustomerChange}},[t.loadingCustomer?e("a-spin",{attrs:{slot:"notFoundContent",size:"small"},slot:"notFoundContent"}):t._e(),t._l(t.customerOption,function(n){return e("a-select-option",{key:n.id,attrs:{value:n.id}},[t._v(t._s(n.username))])})],2)],1),e("a-form-item",{attrs:{label:"Exp Date",required:!0,"validate-status":null==t.help.exp_date||""===t.help.exp_date?null:"error",help:t.help.exp_date}},[e("a-date-picker",{model:{value:t.form.exp_date,callback:function(n){t.$set(t.form,"exp_date",n)},expression:"form.exp_date"}})],1),e("a-form-item",{attrs:{label:"Amount",required:!0,"validate-status":null==t.help.amount||""===t.help.amount?null:"error",help:t.help.amount}},[e("a-input-number",{staticStyle:{width:"200px"},attrs:{min:0,defaultValue:0,precision:2,step:.5},model:{value:t.form.amount,callback:function(n){t.$set(t.form,"amount",n)},expression:"form.amount"}})],1),e("a-form-item",{attrs:{label:"Enable"}},[e("a-switch",{attrs:{checkedChildren:"Enable",unCheckedChildren:"Disable(禁用)"},model:{value:t.form.enable,callback:function(n){t.$set(t.form,"enable",n)},expression:"form.enable"}})],1),e("a-form-item",[[e("a-button",{key:"back",on:{click:function(n){t.visible=!1}}},[t._v("Return")]),e("a-button",{key:"submit",style:{marginLeft:"8px"},attrs:{type:"primary",loading:t.loading},on:{click:function(n){t.isEdit?t.updateForm():t.createForm()}}},[t._v("Submit")])]],2)],1)],1)},a=[],o=(e("c5f6"),e("cbfe")),i=e("d96b"),u=e("0fea"),c=e("f3b8"),d=e("c1df"),l=e.n(d),s=e("b047"),f=e.n(s),m={name:"CouponDetail",props:{isEdit:{type:Boolean,default:!1}},data:function(){return{visible:!1,loading:!1,product_id:void 0,productOption:[],variantOption:[],customerOption:[],labelCol:{xs:{span:24},sm:{span:5}},wrapperCol:{xs:{span:24},sm:{span:16}},form:{id:void 0,couponID:void 0,enable:!0,amount:0,exp_date:l()(new Date,"YYYY-MM-DD"),description:"",variant_id:void 0,customer_id:[]},help:{variant_id:"",customer_id:"",exp_date:"",amount:""},loadingProduct:!1,loadingCustomer:!1}},mounted:function(){if(this.handleProductSearch=f()(this.handleProductSearch,1e3),this.isEdit){var t=this.$route.params&&this.$route.params.id;this.fetch(t)}},methods:{handleGoBack:function(){this.$router.go(-1)},fetch:function(t){var n=this;this.loading=!0,Object(o["b"])(t).then(function(t){var e=t.result;return Object.assign(n.form,e,{exp_date:l()(new Date(e.exp_date),"YYYY-MM-DD"),customer_id:e.customer.map(function(t){return t.id})}),n.customerOption=e.customer,Object(i["e"])(e.variant.product_id)}).then(function(t){var e=t.result;n.productOption=[e],n.variantOption=e.variant,n.product_id=e.id}).finally(function(){n.loading=!1})},handleCreate:function(){this.form={couponID:void 0,enable:!0,amount:0,exp_date:l()(new Date,"YYYY-MM-DD"),description:"",variant_id:void 0,customer_id:[]},this.product=null,this.variant=null,this.visible=!0,this.isEdit=!1},handleEdit:function(t){this.form=Object.assign({},t),this.visible=!0,this.isEdit=!0},handleProductSearch:function(t){var n=this;this.loadingProduct=!0,Object(i["f"])({search:t}).then(function(t){var e=t.result;n.productOption=e}).finally(function(){n.loadingProduct=!1})},handleProductChange:function(t){var n=this;this.product_id=t,this.form.variant_id=null,this.variantOption=[],t&&Object(i["e"])(t).then(function(t){var e=t.result;n.variantOption=e.variant})},handleVariantChange:function(t){this.form.variant_id=t},handleCustomerSearch:function(t){var n=this;this.loadingCustomer=!0,Object(u["e"])({search:t}).then(function(t){var e=t.result;n.customerOption=e}).finally(function(){n.loadingCustomer=!1})},handleCustomerChange:function(t){this.form.customer_id=t},updateForm:function(){var t=this,n={enable:this.form.enable,amount:Number(this.form.amount),exp_date:this.form.exp_date?this.form.exp_date.format("YYYY-MM-DD"):void 0,description:this.form.description,variant_id:this.form.variant_id,customer_id:this.form.customer_id};this.loading=!0,Object(o["d"])(this.form.id,n).then(function(n){t.handleGoBack()}).catch(function(n){t.checkError(n)}).finally(function(){t.loading=!1})},createForm:function(){var t=this,n={enable:this.form.enable,amount:Number(this.form.amount),exp_date:this.form.exp_date?this.form.exp_date.format("YYYY-MM-DD"):void 0,description:this.form.description,variant_id:this.form.variant_id,customer_id:this.form.customer_id};this.loading=!0,Object(o["a"])(n).then(function(n){t.handleGoBack()}).catch(function(n){t.checkError(n)}).finally(function(){t.loading=!1})},checkError:function(t){var n=Object(c["a"])(t,"variant_id","customer_id","exp_date","amount");for(var e in this.help.variant_id=n["variant_id"],this.help.customer_id=n["customer_id"],this.help.exp_date=n["exp_date"],this.help.amount=n["amount"],n)n[e]&&this.$notification["error"]({message:e,description:n[e],duration:4})}}},h=m,p=e("2877"),b=Object(p["a"])(h,r,a,!1,null,null,null);n["a"]=b.exports},cbfe:function(t,n,e){"use strict";e.d(n,"c",function(){return o}),e.d(n,"b",function(){return i}),e.d(n,"d",function(){return u}),e.d(n,"a",function(){return c});var r=e("365c"),a=e("b775");function o(t){return Object(a["b"])({url:r["a"].coupon,method:"get",params:t})}function i(t){return Object(a["b"])({url:r["a"].coupon+"".concat(t,"/"),method:"get"})}function u(t,n){return Object(a["b"])({url:r["a"].coupon+"".concat(t,"/"),method:"put",data:n})}function c(t){return Object(a["b"])({url:r["a"].coupon,method:"post",data:t})}},d96b:function(t,n,e){"use strict";e.d(n,"f",function(){return o}),e.d(n,"e",function(){return i}),e.d(n,"m",function(){return u}),e.d(n,"a",function(){return c}),e.d(n,"c",function(){return d}),e.d(n,"i",function(){return l}),e.d(n,"j",function(){return s}),e.d(n,"h",function(){return f}),e.d(n,"g",function(){return m}),e.d(n,"n",function(){return h}),e.d(n,"b",function(){return p}),e.d(n,"d",function(){return b}),e.d(n,"k",function(){return v}),e.d(n,"l",function(){return _});var r=e("365c"),a=e("b775");function o(t){return Object(a["b"])({url:r["a"].product+"?backend=0",method:"get",params:t})}function i(t){return Object(a["b"])({url:r["a"].product+"".concat(t,"/")+"?backend=0",method:"get"})}function u(t,n){return Object(a["b"])({url:r["a"].product+"".concat(t,"/")+"?backend=0",method:"put",data:n})}function c(t){return Object(a["b"])({url:r["a"].product+"?backend=0",method:"post",data:t})}function d(t){return Object(a["b"])({url:r["a"].product+"".concat(t,"/")+"?backend=0",method:"delete"})}function l(t){return Object(a["b"])({url:r["a"].product+"delete/",method:"delete",params:t})}function s(t){return Object(a["b"])({url:r["a"].product+"enable/",method:"post",params:t})}function f(t){return Object(a["b"])({url:r["a"].variant+"?backend=0",method:"get",params:t})}function m(t){return Object(a["b"])({url:r["a"].variant+"".concat(t,"/")+"?backend=0",method:"get"})}function h(t,n){return Object(a["b"])({url:r["a"].variant+"".concat(t,"/")+"?backend=0",method:"put",data:n})}function p(t){return Object(a["b"])({url:r["a"].variant+"?backend=0",method:"post",data:t})}function b(t){return Object(a["b"])({url:r["a"].variant+"".concat(t,"/")+"?backend=0",method:"delete"})}function v(t){return Object(a["b"])({url:r["a"].variant+"delete/",method:"delete",params:t})}function _(t){return Object(a["b"])({url:r["a"].variant+"enable/",method:"post",params:t})}},f3b8:function(t,n,e){"use strict";function r(t){if(t&&t.response&&t.response.data&&t.response.data.message){for(var n={},e=arguments.length,r=new Array(e>1?e-1:0),a=1;a<e;a++)r[a-1]=arguments[a];for(var o=0,i=r;o<i.length;o++){var u=i[o];n[u]=t.response.data.message[u]||null}return n}return null}e.d(n,"a",function(){return r})}}]);