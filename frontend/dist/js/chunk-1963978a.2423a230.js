(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-1963978a"],{"184f":function(t,e,l){"use strict";var a=function(){var t=this,e=t.$createElement,l=t._self._c||e;return l("a-spin",{attrs:{spinning:t.spinning}},[l("a-card",[l("a-form",{attrs:{form:t.form}},[l("a-form-item",{attrs:{label:"Status",required:!0}},[l("a-switch",{attrs:{checkedChildren:"上架",unCheckedChildren:"下架",checked:t.status},on:{change:t.handleStatusChange}})],1),l("a-form-item",{attrs:{label:"Category",required:!0,"validate-status":null==t.category.help||""===t.category.help?null:"error",help:t.category.help}},[l("a-select",{attrs:{value:t.category.value,filterOption:!1},on:{change:t.category.handleChange}},t._l(t.categoryData,function(e){return l("a-select-option",{key:e.value},[t._v(t._s(e.label))])}),1)],1),l("a-form-item",{attrs:{label:"Product ID",required:!0,"validate-status":null==t.productID.help||""===t.productID.help?null:"error",help:t.productID.help}},[l("a-input",{model:{value:t.productID.data,callback:function(e){t.$set(t.productID,"data",e)},expression:"productID.data"}})],1),l("a-form-item",{attrs:{label:"Title",required:!0,"validate-status":null==t.title.help||""===t.title.help?null:"error",help:t.title.help}},[l("a-input",{model:{value:t.title.data,callback:function(e){t.$set(t.title,"data",e)},expression:"title.data"}})],1),l("a-form-item",{attrs:{label:"SubTitle",required:!0,"validate-status":null==t.subtitle.help||""===t.subtitle.help?null:"error",help:t.subtitle.help}},[l("a-textarea",{attrs:{rows:5},model:{value:t.subtitle.data,callback:function(e){t.$set(t.subtitle,"data",e)},expression:"subtitle.data"}})],1),l("a-form-item",{attrs:{label:"Location",required:!0,"validate-status":null==t.location.help||""===t.location.help?null:"error",help:t.location.help}},[l("a-input",{model:{value:t.location.data,callback:function(e){t.$set(t.location,"data",e)},expression:"location.data"}})],1),t.title.data?l("a-form-item",{attrs:{label:"Photo",required:!0,"validate-status":null==t.photo.help||""===t.photo.help?null:"error",help:t.photo.help}},[l("a-upload",{attrs:{showUploadList:!1,beforeUpload:t.beforeUpload,remove:t.photo.remove,customRequest:t.photo.request,listType:"picture-card"}},[t.photo.file?l("img",{attrs:{src:t.photo.file.url,alt:"photo"}}):l("div",[l("a-icon",{attrs:{type:t.photo.loading?"loading":"plus"}}),l("div",{staticClass:"ant-upload-text"},[t._v("Upload")])],1)])],1):t._e(),t.title.data?l("a-form-item",{attrs:{label:"Gallery",required:!0,"validate-status":null==t.gallery.help||""===t.gallery.help?null:"error",help:t.gallery.help}},[l("a-upload",{attrs:{fileList:t.gallery.file,beforeUpload:t.beforeUpload,remove:t.gallery.remove,customRequest:t.gallery.request,listType:"picture-card"}},[t.gallery.file.length<8?l("div",[l("a-icon",{attrs:{type:"plus"}}),l("div",{staticClass:"ant-upload-text"},[t._v("Upload")])],1):t._e()])],1):t._e(),l("a-form-item",{attrs:{label:"Special",required:!0,"validate-status":null==t.special.help||""===t.special.help?null:"error",help:t.special.help}},[l("div",{staticClass:"components-container"},[l("div",[l("tinymce",{attrs:{height:150},model:{value:t.special.data,callback:function(e){t.$set(t.special,"data",e)},expression:"special.data"}})],1)])]),l("a-form-item",{attrs:{label:"Content",required:!0,"validate-status":null==t.content.help||""===t.content.help?null:"error",help:t.content.help}},[l("div",{staticClass:"components-container"},[l("div",[l("tinymce",{attrs:{height:500},model:{value:t.content.data,callback:function(e){t.$set(t.content,"data",e)},expression:"content.data"}})],1)])])],1),l("a-row",[l("a-col",{attrs:{span:"2"}},[l("a-button",{attrs:{type:"primary","html-type":"submit"},on:{click:t.handleSubmit}},[t._v("Submit")])],1),l("a-col",{attrs:{span:"2"}},[l("a-button",{on:{click:t.handleGoBack}},[t._v("Return")])],1)],1)],1)],1)},i=[],n=(l("ac4d"),l("8a81"),l("ac6a"),l("88bc"),l("8256")),r=l("f3b8"),o=l("b414"),s=l("c4c8"),u=[{value:1,label:"美食"},{value:2,label:"门票"},{value:3,label:"日游"},{value:4,label:"用车"},{value:5,label:"酒店"},{value:6,label:"伴手礼"}],c={name:"ProductDetail",components:{Tinymce:n["a"]},props:{isEdit:{type:Boolean,default:!1}},data:function(){var t=this;return{categoryData:u,labelCol:{xs:{span:24},sm:{span:2}},wrapperCol:{xs:{span:24},sm:{span:15}},buttonCol:{wrapperCol:{xs:{span:24},sm:{span:6}}},form:this.$form.createForm(this),status:!0,category:{value:null,help:null,handleChange:function(e){t.category.value=e}},photo:{data:null,file:null,help:null,loading:!1,remove:function(t){photo.data=null,photo.file=null},request:function(e){var l=new FormData;l.append("image",e.file),l.append("flag","icon"),l.append("title",t.title.data),Object(o["a"])(l).then(function(e){var l=e.result;t.photo.data=l,t.photo.file={uid:l.uid,name:l.title,status:"done",url:l.image.thumbnail},t.$message.success("Upload successfully.")}).catch(function(e){t.$message.error("Upload failed.")})}},gallery:{data:[],file:[],help:null,remove:function(e){var l=t.gallery.data.indexOf(e),a=t.gallery.data.slice();a.splice(l,1),t.gallery.data=a;var i=t.gallery.file.indexOf(e),n=t.gallery.file.slice();n.splice(i,1),t.gallery.file=n},request:function(e){var l=new FormData;l.append("image",e.file),l.append("flag","gallery"),l.append("title",t.title.data),Object(o["a"])(l).then(function(e){var l=e.result;t.gallery.data.push(l),t.gallery.file.push({uid:l.uid,name:l.title,status:"done",url:l.image.full_size}),t.$message.success("Upload successfully.")}).catch(function(e){t.$message.error("Upload failed.")})}},content:{data:null,help:null},subtitle:{data:null,help:null},productID:{data:null,help:null},title:{data:null,help:null},special:{data:null,help:null},location:{data:null,help:null},spinning:!1}},created:function(){if(this.isEdit){var t=this.$route.params&&this.$route.params.id;this.fetch(t)}},methods:{handleGoBack:function(){this.$router.go(-1)},fetch:function(t){var e=this;this.spinning=!0,Object(s["d"])(t).then(function(t){var l=t.result;e.initData(l)}).finally(function(){e.spinning=!1})},updateForm:function(t){var e=this;this.spinning=!0,Object(s["f"])(this.$route.params.id,t).then(function(t){t.result;e.handleGoBack()}).catch(function(t){e.checkError(t)}).finally(function(){e.spinning=!1})},createForm:function(t){var e=this;this.spinning=!0,Object(s["a"])(t).then(function(t){t.result;e.handleGoBack()}).finally(function(){e.spinning=!1})},checkError:function(t){var e=Object(r["a"])(t,"category","productID","title","subtitle","location","photo","gallery","special","content");for(var l in this.category.help=e["category"],this.productID.help=e["productID"],this.title.help=e["title"],this.subtitle.help=e["subtitle"],this.location.help=e["location"],this.photo.help=e["photo"],this.gallery.help=e["gallery"],this.special.help=e["special"],this.content.help=e["content"],e)e[l]&&this.$notification["error"]({message:l,description:e[l],duration:4})},initData:function(t){if(this.isEdit&&(this.$route.meta.title=t.title,this.$emit("title")),this.status=t.status,this.category.value=t.category,this.productID={data:t.productID,help:null},this.title={data:t.title,help:null},this.subtitle={data:t.subtitle,help:null},this.location={data:t.location,help:null},this.content={data:t.content,help:null},this.special={data:t.special,help:null},null!=t.photo&&(this.photo.file={uid:t.photo.uid,name:t.photo.title,url:t.photo.image.thumbnail},this.photo.data=t.photo),null!=t.gallery){var e=!0,l=!1,a=void 0;try{for(var i,n=t.gallery[Symbol.iterator]();!(e=(i=n.next()).done);e=!0){var r=i.value;this.gallery.file.push({uid:r.uid,name:r.title,url:r.image.full_size})}}catch(o){l=!0,a=o}finally{try{e||null==n.return||n.return()}finally{if(l)throw a}}this.gallery.data=t.gallery}},handleSubmit:function(){if(null==this.category.value?this.category.help="This field is required.":this.category.help=null,null==this.productID.data||""===this.productID.data?this.productID.help="This field is required.":this.productID.help=null,null==this.title.data||""===this.title.data?this.title.help="This field is required.":this.title.help=null,null==this.subtitle.data||""===this.subtitle.data?this.subtitle.help="This field is required.":this.subtitle.help=null,null==this.location.data||""===this.location.data?this.location.help="This field is required.":this.location.help=null,null==this.photo.data?this.photo.help="This field is required.":this.photo.help=null,null==this.gallery.data||0==this.gallery.data.length?this.gallery.help="This field is required.":this.gallery.help=null,null==this.special.data||""===this.special.data?this.special.help="This field is required.":this.special.help=null,null==this.content.data||""===this.content.data?this.content.help="This field is required.":this.content.help=null,!(this.category.help||this.productID.help||this.title.help||this.subtitle.help||this.location.help||this.photo.help||this.gallery.help||this.special.help||this.content.help)){var t={status:this.status,category:this.category.value,productID:this.productID.data,title:this.title.data,subtitle:this.subtitle.data,location:this.location.data,photo_id:this.photo.data.id,gallery_id:this.gallery.data.map(function(t){if(t)return t.id}),special:this.special.data,content:this.content.data};this.isEdit?this.updateForm(t):this.createForm(t)}},beforeUpload:function(t){var e="image/jpeg"===t.type||"image/png"===t.type;e||this.$message.error("You can only upload JPG or PNG file!");var l=t.size/1024/1024<2;return l||this.$message.error("Image must smaller than 2MB!"),e&&l},handleStatusChange:function(t){this.status=t}}},h=c,p=l("2877"),d=Object(p["a"])(h,a,i,!1,null,null,null);e["a"]=d.exports},"88bc":function(t,e,l){(function(e){var l=1/0,a=9007199254740991,i="[object Arguments]",n="[object Function]",r="[object GeneratorFunction]",o="[object Symbol]",s="object"==typeof e&&e&&e.Object===Object&&e,u="object"==typeof self&&self&&self.Object===Object&&self,c=s||u||Function("return this")();function h(t,e,l){switch(l.length){case 0:return t.call(e);case 1:return t.call(e,l[0]);case 2:return t.call(e,l[0],l[1]);case 3:return t.call(e,l[0],l[1],l[2])}return t.apply(e,l)}function p(t,e){var l=-1,a=t?t.length:0,i=Array(a);while(++l<a)i[l]=e(t[l],l,t);return i}function d(t,e){var l=-1,a=e.length,i=t.length;while(++l<a)t[i+l]=e[l];return t}var f=Object.prototype,m=f.hasOwnProperty,g=f.toString,b=c.Symbol,y=f.propertyIsEnumerable,v=b?b.isConcatSpreadable:void 0,j=Math.max;function D(t,e,l,a,i){var n=-1,r=t.length;l||(l=I),i||(i=[]);while(++n<r){var o=t[n];e>0&&l(o)?e>1?D(o,e-1,l,a,i):d(i,o):a||(i[i.length]=o)}return i}function q(t,e){return t=Object(t),w(t,e,function(e,l){return l in t})}function w(t,e,l){var a=-1,i=e.length,n={};while(++a<i){var r=e[a],o=t[r];l(o,r)&&(n[r]=o)}return n}function O(t,e){return e=j(void 0===e?t.length-1:e,0),function(){var l=arguments,a=-1,i=j(l.length-e,0),n=Array(i);while(++a<i)n[a]=l[e+a];a=-1;var r=Array(e+1);while(++a<e)r[a]=l[a];return r[e]=n,h(t,this,r)}}function I(t){return _(t)||$(t)||!!(v&&t&&t[v])}function k(t){if("string"==typeof t||E(t))return t;var e=t+"";return"0"==e&&1/t==-l?"-0":e}function $(t){return C(t)&&m.call(t,"callee")&&(!y.call(t,"callee")||g.call(t)==i)}var _=Array.isArray;function x(t){return null!=t&&S(t.length)&&!T(t)}function C(t){return F(t)&&x(t)}function T(t){var e=U(t)?g.call(t):"";return e==n||e==r}function S(t){return"number"==typeof t&&t>-1&&t%1==0&&t<=a}function U(t){var e=typeof t;return!!t&&("object"==e||"function"==e)}function F(t){return!!t&&"object"==typeof t}function E(t){return"symbol"==typeof t||F(t)&&g.call(t)==o}var G=O(function(t,e){return null==t?{}:q(t,p(D(e,1),k))});t.exports=G}).call(this,l("c8ba"))},c4c8:function(t,e,l){"use strict";l.d(e,"e",function(){return n}),l.d(e,"d",function(){return r}),l.d(e,"f",function(){return o}),l.d(e,"a",function(){return s}),l.d(e,"c",function(){return u}),l.d(e,"b",function(){return c});var a=l("365c"),i=l("b775");function n(t){return Object(i["b"])({url:a["a"].system_product,method:"get",params:t})}function r(t){return Object(i["b"])({url:a["a"].system_product+"".concat(t,"/"),method:"get"})}function o(t,e){return Object(i["b"])({url:a["a"].system_product+"".concat(t,"/"),method:"put",data:e})}function s(t){return Object(i["b"])({url:a["a"].system_product,method:"post",data:t})}function u(t){return Object(i["b"])({url:a["a"].product,method:"get",params:t})}function c(t){return Object(i["b"])({url:a["a"].product+"".concat(t,"/"),method:"get"})}}}]);