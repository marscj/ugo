(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-73050efc"],{ca9c:function(t,e,a){"use strict";a.r(e);var n=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("a-card",{directives:[{name:"action",rawName:"v-action:query",arg:"query"}],attrs:{bordered:!1}},[a("div",{staticClass:"table-page-search-wrapper"},[a("a-form",{attrs:{layout:"inline"}},[a("a-row",{attrs:{gutter:48}},[a("a-col",{attrs:{md:8,sm:16}},[a("a-form-item",{attrs:{label:"Search"}},[a("a-input",{attrs:{placeholder:"Title or Product ID"},model:{value:t.queryParam.search,callback:function(e){t.$set(t.queryParam,"search",e)},expression:"queryParam.search"}})],1)],1),a("a-col",{attrs:{md:8,sm:16}},[a("a-form-item",{attrs:{label:"Category"}},[a("a-select",{model:{value:t.category,callback:function(e){t.category=e},expression:"category"}},t._l(t.categoryData,function(e){return a("a-select-option",{key:e.value},[t._v(t._s(e.label))])}),1)],1)],1),a("a-col",{attrs:{md:8,sm:16}},[a("a-form-item",{attrs:{label:"Status"}},[a("a-select",{model:{value:t.status,callback:function(e){t.status=e},expression:"status"}},t._l(t.statusData,function(e){return a("a-select-option",{key:e.value},[t._v(t._s(e.label))])}),1)],1)],1)],1)],1)],1),a("div",{staticClass:"table-operator"},[a("a-button",{directives:[{name:"action",rawName:"v-action:add",arg:"add"}],attrs:{type:"primary",icon:"plus"},on:{click:t.handleCreate}},[t._v("Add")]),t.selectedRowKeys.length>0?a("a-button",{directives:[{name:"action",rawName:"v-action:edit",arg:"edit"}],attrs:{type:"default",icon:"unlock"},on:{click:function(e){return t.listProductEnable(!0)}}},[t._v("上架")]):t._e(),t.selectedRowKeys.length>0?a("a-button",{directives:[{name:"action",rawName:"v-action:edit",arg:"edit"}],attrs:{type:"default",icon:"lock"},on:{click:function(e){return t.listProductEnable(!1)}}},[t._v("下架")]):t._e(),t.selectedRowKeys.length>0?a("a-button",{directives:[{name:"action",rawName:"v-action:delete",arg:"delete"}],attrs:{type:"danger",icon:"delete"},on:{click:t.listProductDelete}},[t._v("删除")]):t._e()],1),a("s-table",{ref:"table",attrs:{size:"default",rowKey:function(t){return t.id},columns:t.columns,data:t.loadData,alert:t.options.alert,rowSelection:t.options.rowSelection,bordered:""},scopedSlots:t._u([{key:"photo",fn:function(e){return a("span",{},[[e.photo?a("img",{attrs:{src:e.photo.image.thumbnail,alt:"photo"}}):t._e()]],2)}},{key:"action",fn:function(e,n){return a("span",{},[[a("router-link",{directives:[{name:"action",rawName:"v-action:edit",arg:"edit"}],attrs:{to:{name:"ProductEdit",params:{id:n.id}}}},[t._v("Edit")]),a("a-divider",{directives:[{name:"action",rawName:"v-action:edit",arg:"edit"}],attrs:{type:"vertical"}})],t.$auth("Product.edit")||t.$auth("Product.delete")?a("a-dropdown",[a("a",{staticClass:"ant-dropdown-link"},[t._v("More")]),a("a-menu",{attrs:{slot:"overlay"},slot:"overlay"},[a("a-menu-item",[a("a",{directives:[{name:"action",rawName:"v-action:edit",arg:"edit"}],on:{click:function(e){return t.updateProduct(n,!0)}}},[t._v("上架")]),a("a",{directives:[{name:"action",rawName:"v-action:edit",arg:"edit"}],on:{click:function(e){return t.updateProduct(n,!1)}}},[t._v("下架")]),a("a",{directives:[{name:"action",rawName:"v-action:delete",arg:"delete"}],on:{click:function(e){return t.handleDelete(n)}}},[t._v("删除")])])],1)],1):t._e()],2)}}])})],1)},r=[],o=a("2af9"),c=a("d96b"),i=[{value:0,label:"全部"},{value:1,label:"美食"},{value:2,label:"门票"},{value:3,label:"日游"},{value:4,label:"用车"},{value:5,label:"酒店"},{value:6,label:"伴手礼"}],l=[{value:0,label:"全部"},{value:1,label:"上架"},{value:2,label:"下架"}],u={name:"ProductList",components:{STable:o["e"]},created:function(){var t=this;this.debouncedGetAnswer=_.debounce(function(){t.$refs.table.refresh(!0)},1e3)},watch:{category:function(t,e){this.queryParam.category=0==t?void 0:t,this.$refs.table.refresh(!0)},status:function(t,e){this.queryParam.status=0==t?void 0:1==t,this.$refs.table.refresh(!0)},"queryParam.search":function(t,e){this.debouncedGetAnswer()},selectedRowKeys:function(t,e){this.ids=t.join(",")}},data:function(){var t=this,e=this.$createElement;return{category:0,status:0,categoryData:i,statusData:l,queryParam:{search:void 0,category:null,status:null},columns:[{title:"#",dataIndex:"id",width:40},{title:"Product ID",dataIndex:"productID",width:120},{title:"Category",dataIndex:"category",customRender:function(t,a,n){return e("span",[i[t].label])}},{title:"Title",dataIndex:"title"},{title:"SubTitle",dataIndex:"subtitle"},{title:"Location",dataIndex:"location"},{title:"Photo",width:100,scopedSlots:{customRender:"photo"}},{title:"Status",dataIndex:"status",width:"80px",customRender:function(t,a,n){return e("span",t?["上架"]:["下架"])}},{title:"操作",dataIndex:"action",width:"140px",scopedSlots:{customRender:"action"}}],loadData:function(e){return Object(c["f"])(Object.assign(e,t.queryParam)).then(function(t){return t.result})},selectedRowKeys:[],selectedRows:[],options:{alert:{show:!1,clear:function(){t.selectedRowKeys=[]}},rowSelection:{selectedRowKeys:this.selectedRowKeys,onChange:this.onSelectChange}},ids:null}},methods:{handleCreate:function(t){this.$router.push({name:"ProductCreate"})},handleDelete:function(t){var e=this;e.$confirm({title:"alert",content:"Are you sure delete ".concat(t.title,"?"),okText:"delete",okType:"danger",cancelText:"cancle",onOk:function(){return e.$refs.table.localLoading=!0,Object(c["c"])(t.id).then(function(t){e.onClear(),e.$refs.table.refresh(!0)}).finally(function(){e.$refs.table.localLoading=!1})}})},onSelectChange:function(t,e){this.selectedRowKeys=t,this.selectedRows=e},onClear:function(){this.options.alert.clear(),this.$refs.table.clearSelected()},listProductDelete:function(){var t=this;t.$confirm({title:"alert",content:"Are you sure delete?",okText:"delete",okType:"danger",cancelText:"cancle",onOk:function(){t.$refs.table.localLoading=!0,Object(c["i"])({ids:t.ids}).then(function(e){return t.onClear(),t.$refs.table.refresh(!0)}).finally(function(){t.$refs.table.localLoading=!1})}})},listProductEnable:function(t){var e=this;this.$refs.table.localLoading=!0,Object(c["j"])({ids:this.ids,enable:t?1:0}).then(function(t){return e.onClear(),e.$refs.table.refresh(!0)}).finally(function(){e.$refs.table.localLoading=!1})},updateProduct:function(t,e){var a=this,n=Object.assign({},t,{status:e});console.log(n,"====="),console.log(t,"----"),this.$refs.table.localLoading=!0,Object(c["m"])(t.id,n).then(function(t){return a.onClear(),a.$refs.table.refresh(!0)}).finally(function(){a.$refs.table.localLoading=!1})}}},s=u,d=a("2877"),f=Object(d["a"])(s,n,r,!1,null,null,null);e["default"]=f.exports},d96b:function(t,e,a){"use strict";a.d(e,"f",function(){return o}),a.d(e,"e",function(){return c}),a.d(e,"m",function(){return i}),a.d(e,"a",function(){return l}),a.d(e,"c",function(){return u}),a.d(e,"i",function(){return s}),a.d(e,"j",function(){return d}),a.d(e,"h",function(){return f}),a.d(e,"g",function(){return b}),a.d(e,"n",function(){return h}),a.d(e,"b",function(){return m}),a.d(e,"d",function(){return p}),a.d(e,"k",function(){return v}),a.d(e,"l",function(){return y});var n=a("365c"),r=a("b775");function o(t){return Object(r["b"])({url:n["a"].product+"?backend=0",method:"get",params:t})}function c(t){return Object(r["b"])({url:n["a"].product+"".concat(t,"/")+"?backend=0",method:"get"})}function i(t,e){return Object(r["b"])({url:n["a"].product+"".concat(t,"/")+"?backend=0",method:"put",data:e})}function l(t){return Object(r["b"])({url:n["a"].product+"?backend=0",method:"post",data:t})}function u(t){return Object(r["b"])({url:n["a"].product+"".concat(t,"/")+"?backend=0",method:"delete"})}function s(t){return Object(r["b"])({url:n["a"].product+"delete/",method:"delete",params:t})}function d(t){return Object(r["b"])({url:n["a"].product+"enable/",method:"post",params:t})}function f(t){return Object(r["b"])({url:n["a"].variant+"?backend=0",method:"get",params:t})}function b(t){return Object(r["b"])({url:n["a"].variant+"".concat(t,"/")+"?backend=0",method:"get"})}function h(t,e){return Object(r["b"])({url:n["a"].variant+"".concat(t,"/")+"?backend=0",method:"put",data:e})}function m(t){return Object(r["b"])({url:n["a"].variant+"?backend=0",method:"post",data:t})}function p(t){return Object(r["b"])({url:n["a"].variant+"".concat(t,"/")+"?backend=0",method:"delete"})}function v(t){return Object(r["b"])({url:n["a"].variant+"delete/",method:"delete",params:t})}function y(t){return Object(r["b"])({url:n["a"].variant+"enable/",method:"post",params:t})}}}]);