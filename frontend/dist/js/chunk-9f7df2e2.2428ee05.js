(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-9f7df2e2"],{"184f":function(t,e,a){"use strict";var l=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("a-spin",{attrs:{spinning:t.spinning}},[a("a-card",[a("a-form",{attrs:{form:t.form}},[a("a-form-item",{attrs:{label:"Status",required:!0}},[a("a-switch",{attrs:{checkedChildren:"上架",unCheckedChildren:"下架",checked:t.status},on:{change:t.handleStatusChange}})],1),a("a-form-item",{attrs:{label:"Category",required:!0,"validate-status":null==t.category.help||""===t.category.help?null:"error",help:t.category.help}},[a("a-select",{attrs:{value:t.category.value,filterOption:!1},on:{change:t.category.handleChange}},t._l(t.categoryData,function(e){return a("a-select-option",{key:e.value},[t._v(t._s(e.label))])}),1)],1),a("a-form-item",{attrs:{label:"Product ID",required:!0,"validate-status":null==t.productID.help||""===t.productID.help?null:"error",help:t.productID.help}},[a("a-input",{model:{value:t.productID.data,callback:function(e){t.$set(t.productID,"data",e)},expression:"productID.data"}})],1),a("a-form-item",{attrs:{label:"Title",required:!0,"validate-status":null==t.title.help||""===t.title.help?null:"error",help:t.title.help}},[a("a-input",{model:{value:t.title.data,callback:function(e){t.$set(t.title,"data",e)},expression:"title.data"}})],1),a("a-form-item",{attrs:{label:"SubTitle","validate-status":null==t.subtitle.help||""===t.subtitle.help?null:"error",help:t.subtitle.help}},[a("a-textarea",{attrs:{rows:5},model:{value:t.subtitle.data,callback:function(e){t.$set(t.subtitle,"data",e)},expression:"subtitle.data"}})],1),a("a-form-item",{attrs:{label:"Location","validate-status":null==t.location.help||""===t.location.help?null:"error",help:t.location.help}},[a("a-input",{model:{value:t.location.data,callback:function(e){t.$set(t.location,"data",e)},expression:"location.data"}})],1),a("a-form-item",{attrs:{label:"Sort ID","validate-status":null==t.sort_by.help||""===t.sort_by.help?null:"error",help:t.sort_by.help}},[a("a-input",{model:{value:t.sort_by.data,callback:function(e){t.$set(t.sort_by,"data",e)},expression:"sort_by.data"}})],1),t.title.data?a("a-form-item",{attrs:{label:"Photo","validate-status":null==t.photo.help||""===t.photo.help?null:"error",help:t.photo.help}},[a("a-upload",{attrs:{showUploadList:!1,beforeUpload:t.beforeUpload,remove:t.photo.remove,customRequest:t.photo.request,listType:"picture-card"}},[t.photo.file?a("img",{attrs:{src:t.photo.file.url,alt:"photo"}}):a("div",[a("a-icon",{attrs:{type:t.photo.loading?"loading":"plus"}}),a("div",{staticClass:"ant-upload-text"},[t._v("Upload")])],1)])],1):t._e(),t.title.data?a("a-form-item",{attrs:{label:"Gallery","validate-status":null==t.gallery.help||""===t.gallery.help?null:"error",help:t.gallery.help}},[a("a-upload",{attrs:{fileList:t.gallery.file,beforeUpload:t.beforeUpload,remove:t.gallery.remove,customRequest:t.gallery.request,listType:"picture-card"}},[t.gallery.file.length<8?a("div",[a("a-icon",{attrs:{type:"plus"}}),a("div",{staticClass:"ant-upload-text"},[t._v("Upload")])],1):t._e()])],1):t._e(),a("a-form-item",{attrs:{label:"Special","validate-status":null==t.special.help||""===t.special.help?null:"error",help:t.special.help}},[a("div",{staticClass:"components-container"},[a("div",[a("tinymce",{attrs:{height:150},model:{value:t.special.data,callback:function(e){t.$set(t.special,"data",e)},expression:"special.data"}})],1)])]),a("a-form-item",{attrs:{label:"Content","validate-status":null==t.content.help||""===t.content.help?null:"error",help:t.content.help}},[a("div",{staticClass:"components-container"},[a("div",[a("tinymce",{attrs:{height:500},model:{value:t.content.data,callback:function(e){t.$set(t.content,"data",e)},expression:"content.data"}})],1)])])],1),a("a-row",[a("a-col",{attrs:{span:"2"}},[a("a-button",{attrs:{type:"primary","html-type":"submit"},on:{click:t.handleSubmit}},[t._v("Submit")])],1),a("a-col",{attrs:{span:"2"}},[a("a-button",{on:{click:t.handleGoBack}},[t._v("Return")])],1)],1)],1)],1)},n=[],r=(a("ac4d"),a("8a81"),a("ac6a"),a("88bc"),a("8256")),i=a("f3b8"),o=a("b414"),u=a("d96b"),s=[{value:1,label:"美食"},{value:2,label:"门票"},{value:3,label:"日游"},{value:4,label:"用车"},{value:5,label:"酒店"},{value:6,label:"伴手礼"}],c={name:"ProductDetail",components:{Tinymce:r["a"]},props:{isEdit:{type:Boolean,default:!1}},data:function(){var t=this;return{categoryData:s,labelCol:{xs:{span:24},sm:{span:2}},wrapperCol:{xs:{span:24},sm:{span:15}},buttonCol:{wrapperCol:{xs:{span:24},sm:{span:6}}},form:this.$form.createForm(this),status:!0,category:{value:1,help:null,handleChange:function(e){t.category.value=e}},photo:{data:null,file:null,help:null,loading:!1,remove:function(t){photo.data=null,photo.file=null},request:function(e){var a=new FormData;a.append("image",e.file),a.append("flag","icon"),a.append("title",t.title.data),Object(o["a"])(a).then(function(e){var a=e.result;t.photo.data=a,t.photo.file={uid:a.uid,name:a.title,status:"done",url:a.image.thumbnail},t.$message.success("Upload successfully.")}).catch(function(e){t.$message.error("Upload failed.")})}},gallery:{data:[],file:[],help:null,remove:function(e){var a=t.gallery.data.indexOf(e),l=t.gallery.data.slice();l.splice(a,1),t.gallery.data=l;var n=t.gallery.file.indexOf(e),r=t.gallery.file.slice();r.splice(n,1),t.gallery.file=r},request:function(e){var a=new FormData;a.append("image",e.file),a.append("flag","gallery"),a.append("title",t.title.data),Object(o["a"])(a).then(function(e){var a=e.result;t.gallery.data.push(a),t.gallery.file.push({uid:a.uid,name:a.title,status:"done",url:a.image.full_size}),t.$message.success("Upload successfully.")}).catch(function(e){t.$message.error("Upload failed.")})}},content:{data:null,help:null},subtitle:{data:null,help:null},productID:{data:null,help:null},sort_by:{data:null,help:null},title:{data:null,help:null},special:{data:null,help:null},location:{data:null,help:null},spinning:!1}},created:function(){if(this.isEdit){var t=this.$route.params&&this.$route.params.id;this.fetch(t)}},methods:{handleGoBack:function(){this.$router.go(-1)},fetch:function(t){var e=this;this.spinning=!0,Object(u["e"])(t).then(function(t){var a=t.result;e.initData(a)}).finally(function(){e.spinning=!1})},updateForm:function(t){var e=this;this.spinning=!0,Object(u["m"])(this.$route.params.id,t).then(function(t){t.result;e.handleGoBack()}).catch(function(t){e.checkError(t)}).finally(function(){e.spinning=!1})},createForm:function(t){var e=this;this.spinning=!0,Object(u["a"])(t).then(function(t){t.result;e.handleGoBack()}).catch(function(t){e.checkError(t)}).finally(function(){e.spinning=!1})},checkError:function(t){var e=Object(i["a"])(t,"category","productID","sort_by","title","subtitle","location","photo","gallery","special","content");for(var a in this.category.help=e["category"],this.productID.help=e["productID"],this.sort_by.help=e["sort_by"],this.title.help=e["title"],this.subtitle.help=e["subtitle"],this.location.help=e["location"],this.photo.help=e["photo"],this.gallery.help=e["gallery"],this.special.help=e["special"],this.content.help=e["content"],e)e[a]&&this.$notification["error"]({message:a,description:e[a],duration:4})},initData:function(t){if(this.isEdit&&(this.$route.meta.title=t.title,this.$emit("title")),this.status=t.status,this.category.value=t.category,this.productID={data:t.productID,help:null},this.sort_by={data:t.sort_by,help:null},this.title={data:t.title,help:null},this.subtitle={data:t.subtitle,help:null},this.location={data:t.location,help:null},this.content={data:t.content,help:null},this.special={data:t.special,help:null},null!=t.photo&&(this.photo.file={uid:t.photo.uid,name:t.photo.title,url:t.photo.image.thumbnail},this.photo.data=t.photo),null!=t.gallery){var e=!0,a=!1,l=void 0;try{for(var n,r=t.gallery[Symbol.iterator]();!(e=(n=r.next()).done);e=!0){var i=n.value;this.gallery.file.push({uid:i.uid,name:i.title,url:i.image.full_size})}}catch(o){a=!0,l=o}finally{try{e||null==r.return||r.return()}finally{if(a)throw l}}this.gallery.data=t.gallery}},handleSubmit:function(){if(null==this.category.value?this.category.help="This field is required.":this.category.help=null,null==this.productID.data||""===this.productID.data?this.productID.help="This field is required.":this.productID.help=null,this.sort_by.help=null,null==this.title.data||""===this.title.data?this.title.help="This field is required.":this.title.help=null,this.subtitle.help=null,this.location.help=null,this.photo.help=null,this.gallery.help=null,this.special.help=null,this.content.help=null,!(this.category.help||this.productID.help||this.sort_by.help||this.title.help||this.subtitle.help||this.location.help||this.photo.help||this.gallery.help||this.special.help||this.content.help)){var t={status:this.status,category:this.category.value,productID:this.productID.data,sort_by:this.sort_by.data,title:this.title.data,subtitle:this.subtitle.data,location:this.location.data,photo_id:null!=this.photo.data?this.photo.data.id:null,gallery_id:this.gallery.data.map(function(t){if(t)return t.id}),special:this.special.data,content:this.content.data};this.isEdit?this.updateForm(t):this.createForm(t)}},beforeUpload:function(t){var e="image/jpeg"===t.type||"image/png"===t.type;e||this.$message.error("You can only upload JPG or PNG file!");var a=t.size/1024/1024<2;return a||this.$message.error("Image must smaller than 2MB!"),e&&a},handleStatusChange:function(t){this.status=t}}},h=c,p=a("2877"),d=Object(p["a"])(h,l,n,!1,null,null,null);e["a"]=d.exports},"88bc":function(t,e,a){(function(e){var a=1/0,l=9007199254740991,n="[object Arguments]",r="[object Function]",i="[object GeneratorFunction]",o="[object Symbol]",u="object"==typeof e&&e&&e.Object===Object&&e,s="object"==typeof self&&self&&self.Object===Object&&self,c=u||s||Function("return this")();function h(t,e,a){switch(a.length){case 0:return t.call(e);case 1:return t.call(e,a[0]);case 2:return t.call(e,a[0],a[1]);case 3:return t.call(e,a[0],a[1],a[2])}return t.apply(e,a)}function p(t,e){var a=-1,l=t?t.length:0,n=Array(l);while(++a<l)n[a]=e(t[a],a,t);return n}function d(t,e){var a=-1,l=e.length,n=t.length;while(++a<l)t[n+a]=e[a];return t}var f=Object.prototype,b=f.hasOwnProperty,m=f.toString,g=c.Symbol,y=f.propertyIsEnumerable,v=g?g.isConcatSpreadable:void 0,j=Math.max;function k(t,e,a,l,n){var r=-1,i=t.length;a||(a=w),n||(n=[]);while(++r<i){var o=t[r];e>0&&a(o)?e>1?k(o,e-1,a,l,n):d(n,o):l||(n[n.length]=o)}return n}function _(t,e){return t=Object(t),O(t,e,function(e,a){return a in t})}function O(t,e,a){var l=-1,n=e.length,r={};while(++l<n){var i=e[l],o=t[i];a(o,i)&&(r[i]=o)}return r}function D(t,e){return e=j(void 0===e?t.length-1:e,0),function(){var a=arguments,l=-1,n=j(a.length-e,0),r=Array(n);while(++l<n)r[l]=a[e+l];l=-1;var i=Array(e+1);while(++l<e)i[l]=a[l];return i[e]=r,h(t,this,i)}}function w(t){return x(t)||$(t)||!!(v&&t&&t[v])}function I(t){if("string"==typeof t||G(t))return t;var e=t+"";return"0"==e&&1/t==-a?"-0":e}function $(t){return S(t)&&b.call(t,"callee")&&(!y.call(t,"callee")||m.call(t)==n)}var x=Array.isArray;function C(t){return null!=t&&U(t.length)&&!q(t)}function S(t){return E(t)&&C(t)}function q(t){var e=F(t)?m.call(t):"";return e==r||e==i}function U(t){return"number"==typeof t&&t>-1&&t%1==0&&t<=l}function F(t){var e=typeof t;return!!t&&("object"==e||"function"==e)}function E(t){return!!t&&"object"==typeof t}function G(t){return"symbol"==typeof t||E(t)&&m.call(t)==o}var T=D(function(t,e){return null==t?{}:_(t,p(k(e,1),I))});t.exports=T}).call(this,a("c8ba"))},d96b:function(t,e,a){"use strict";a.d(e,"f",function(){return r}),a.d(e,"e",function(){return i}),a.d(e,"m",function(){return o}),a.d(e,"a",function(){return u}),a.d(e,"c",function(){return s}),a.d(e,"i",function(){return c}),a.d(e,"j",function(){return h}),a.d(e,"h",function(){return p}),a.d(e,"g",function(){return d}),a.d(e,"n",function(){return f}),a.d(e,"b",function(){return b}),a.d(e,"d",function(){return m}),a.d(e,"k",function(){return g}),a.d(e,"l",function(){return y});var l=a("365c"),n=a("b775");function r(t){return Object(n["b"])({url:l["a"].product+"?backend=0",method:"get",params:t})}function i(t){return Object(n["b"])({url:l["a"].product+"".concat(t,"/")+"?backend=0",method:"get"})}function o(t,e){return Object(n["b"])({url:l["a"].product+"".concat(t,"/")+"?backend=0",method:"put",data:e})}function u(t){return Object(n["b"])({url:l["a"].product+"?backend=0",method:"post",data:t})}function s(t){return Object(n["b"])({url:l["a"].product+"".concat(t,"/")+"?backend=0",method:"delete"})}function c(t){return Object(n["b"])({url:l["a"].product+"delete/",method:"delete",params:t})}function h(t){return Object(n["b"])({url:l["a"].product+"enable/",method:"post",params:t})}function p(t){return Object(n["b"])({url:l["a"].variant+"?backend=0",method:"get",params:t})}function d(t){return Object(n["b"])({url:l["a"].variant+"".concat(t,"/")+"?backend=0",method:"get"})}function f(t,e){return Object(n["b"])({url:l["a"].variant+"".concat(t,"/")+"?backend=0",method:"put",data:e})}function b(t){return Object(n["b"])({url:l["a"].variant+"?backend=0",method:"post",data:t})}function m(t){return Object(n["b"])({url:l["a"].variant+"".concat(t,"/")+"?backend=0",method:"delete"})}function g(t){return Object(n["b"])({url:l["a"].variant+"delete/",method:"delete",params:t})}function y(t){return Object(n["b"])({url:l["a"].variant+"enable/",method:"post",params:t})}}}]);